(env) (base) minjunes@Minjunes-MacBook-Pro-3 vcc % python explore_vcc_data.py
Files in /Users/minjunes/Downloads/vcc_data:
  adata_Training.h5ad (14765.3 MB)
  gene_names.csv (0.1 MB)
  pert_counts_Validation.csv (0.0 MB)
================================================================================
EXPLORING TRAINING DATA
================================================================================

Loading training data from: /Users/minjunes/Downloads/vcc_data/adata_Training.h5ad

Data shape: (221273, 18080)
  Cells (n_obs): 221,273
  Genes (n_vars): 18,080

--- Cell Metadata (obs) ---
Columns: ['target_gene', 'guide_id', 'batch']

First 5 rows:
                                   target_gene  ...      batch
AAACAAGCAACCTTGTACTTTAGG-Flex_1_01       CHMP3  ...  Flex_1_01
AAACAAGCATTGCCGCACTTTAGG-Flex_1_01        AKT2  ...  Flex_1_01
AAACCAATCAATGTTCACTTTAGG-Flex_1_01       SHPRH  ...  Flex_1_01
AAACCAATCCCTCGCTACTTTAGG-Flex_1_01      TMSB4X  ...  Flex_1_01
AAACCAATCTAAATCCACTTTAGG-Flex_1_01       KLF10  ...  Flex_1_01

[5 rows x 3 columns]

--- Perturbation Information ---
Unique target genes: 151
Total perturbations (including controls): 221273

Control cells (non-targeting): 38,176 (17.3%)

Top 10 most frequent target genes:
target_gene
non-targeting    38176
TMSB4X            4760
PRCP              4331
TADA1             4035
HIRA              3407
IGF2R             3109
NCK2              2929
MED13             2787
MED12             2766
STAT1             2493
Name: count, dtype: int64

--- Batch Information ---
Unique batches: 48
Batch distribution:
batch
Flex_3_10    5082
Flex_3_06    5068
Flex_3_15    5038
Flex_3_11    4988
Flex_3_08    4988
Name: count, dtype: int64

--- Guide Information ---
Unique guide IDs: 189
/Users/minjunes/vcc/explore_vcc_data.py:69: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  guides_per_gene = adata.obs.groupby('target_gene')['guide_id'].nunique()
Average guides per target gene: 1.25
Max guides per target gene: 31

--- Gene Metadata (var) ---
Columns: ['gene_id']

First 5 genes:
                 gene_id
SAMD11   ENSG00000187634
NOC2L    ENSG00000188976
KLHL17   ENSG00000187961
PLEKHN1  ENSG00000187583
PERM1    ENSG00000187642

--- Expression Data ---
Data type: <class 'scipy.sparse._csr.csr_matrix'>
Sparse matrix: False
Sparsity: 51.69%
Max value: 2365.0

Expression statistics (1000 cell sample):
  Mean expression: 3.20
  Median expression: 0.00
  95th percentile: 14.00
  99th percentile: 33.00

--- UMI Counts ---
Mean UMI per cell: 56904
Median UMI per cell: 53912
Min UMI per cell: 19981
Max UMI per cell: 431281

================================================================================
EXPLORING VALIDATION DATA
================================================================================

Loading validation data from: /Users/minjunes/Downloads/vcc_data/pert_counts_Validation.csv

Validation data shape: (50, 3)
Columns: ['target_gene', 'n_cells', 'median_umi_per_cell']

First 10 rows:
  target_gene  n_cells  median_umi_per_cell
0      SH3BP4     2925              54551.0
1      ZNF581     2502              53803.5
2       ANXA6     2496              55175.0
3     PACSIN3     2101              54088.0
4       MGST1     2096              54217.5
5       IGF1R     2056              53993.0
6       ITGAV     2034              55356.0
7       SLIRP     2000              54438.5
8        CTSV     1989              53173.0
9       MTFR1     1787              53795.0

--- Statistics ---
Total target genes to predict: 50
Total cells to predict: 60,751

Cells per perturbation:
  Mean: 1215
  Median: 1090
  Min: 161
  Max: 2925

Median UMI per cell:
  Mean: 54082
  Min: 38650
  Max: 63176

================================================================================
ANALYZING PERTURBATION EFFECTS
================================================================================

Control cells: 38,176
Mean control expression: 3.18

--- Perturbation: CHMP3 ---
Number of cells: 1168
Target gene expression:
  Control: 2.40
  Perturbed: 0.13
  Fold change: 0.05

Top upregulated genes:
  VIM: 1.05 log2FC
  SERPINB9: 0.91 log2FC
  PCDH7: 0.69 log2FC
  HIST1H3E: 0.67 log2FC
  LEFTY1: 0.65 log2FC

Top downregulated genes:
  CHMP3: -1.59 log2FC
  DUSP6: -0.77 log2FC
  DUSP5: -0.58 log2FC
  RASGRP2: -0.58 log2FC
  AK4: -0.57 log2FC

--- Perturbation: AKT2 ---
Number of cells: 938
Target gene expression:
  Control: 7.40
  Perturbed: 0.43
  Fold change: 0.06

Top upregulated genes:
  EPHB3: 0.53 log2FC
  SHISA2: 0.36 log2FC
  LMO3: 0.34 log2FC
  LEFTY1: 0.31 log2FC
  VGF: 0.28 log2FC

Top downregulated genes:
  AKT2: -2.55 log2FC
  CNFN: -1.23 log2FC
  ZNF483: -1.09 log2FC
  DHCR7: -1.03 log2FC
  IGSF21: -0.99 log2FC

--- Perturbation: SHPRH ---
Number of cells: 241
Target gene expression:
  Control: 3.51
  Perturbed: 0.29
  Fold change: 0.08

Top upregulated genes:
  MT-CO3: 0.62 log2FC
  MT-CYB: 0.54 log2FC
  CDKN1A: 0.54 log2FC
  MT-ATP6: 0.45 log2FC
  MT-ND4: 0.36 log2FC

Top downregulated genes:
  VIM: -2.36 log2FC
  KCNK5: -1.99 log2FC
  SHPRH: -1.81 log2FC
  GSN: -1.81 log2FC
  CLMP: -1.10 log2FC

--- Perturbation: TMSB4X ---
Number of cells: 4760
Target gene expression:
  Control: 135.49
  Perturbed: 6.40
  Fold change: 0.05

Top upregulated genes:
  SERPINB9: 0.07 log2FC
  CCN2: 0.07 log2FC
  LEFTY1: 0.06 log2FC
  FOS: 0.06 log2FC
  COL9A3: 0.05 log2FC

Top downregulated genes:
  TMSB4X: -4.21 log2FC
  ACTG1: -0.23 log2FC
  ACTB: -0.16 log2FC
  NUDT14: -0.10 log2FC
  CNN2: -0.09 log2FC

--- Perturbation: KLF10 ---
Number of cells: 1932
Target gene expression:
  Control: 2.66
  Perturbed: 0.64
  Fold change: 0.24

Top upregulated genes:
  KLF15: 0.64 log2FC
  ABAT: 0.56 log2FC
  ALDH6A1: 0.54 log2FC
  HK2: 0.39 log2FC
  ALDH1L1: 0.31 log2FC

Top downregulated genes:
  ROBO1: -1.53 log2FC
  KLF10: -1.16 log2FC
  USF1: -0.82 log2FC
  MYD88: -0.69 log2FC
  AKAP7: -0.46 log2FC

================================================================================
CHECKING GENE OVERLAP
================================================================================

Training data:
  Total genes in expression matrix: 18,080
  Unique perturbed genes: 150

Validation data:
  Target genes to predict: 50

Overlap analysis:
  Validation genes in training perturbations: 0 (0.0%)
  Validation genes NOT in training perturbations: 50 (100.0%)

Validation genes not perturbed in training:
  ACLY (exists in expression matrix)
  ANXA6 (exists in expression matrix)
  ARPC2 (exists in expression matrix)
  CENPB (exists in expression matrix)
  COX4I1 (exists in expression matrix)
  COX6C (exists in expression matrix)
  CSK (exists in expression matrix)
  CTSV (exists in expression matrix)
  CXCL12 (exists in expression matrix)
  DOT1L (exists in expression matrix)

Saved analysis summary to: vcc_data_summary.json

================================================================================
ANALYSIS COMPLETE
================================================================================